<html>
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
        <link rel="stylesheet" href="main.css">
    </head>
    
    <body>    
        <div id="field">
            <h1>在室表</h1>

            <span id="view_time"></span>

            <script type="text/javascript">
            document.getElementById("view_time").innerHTML = getNow();

            function getNow() {
                var now = new Date();
                var year = now.getFullYear();
                var mon = now.getMonth()+1; //１を足すこと
                var day = now.getDate();
                var hour = now.getHours();
                var min = now.getMinutes();
                var sec = now.getSeconds();

                //出力用
                var s = year + "/" + mon + "/" + day + " " + hour + ":" + min; 
                return s;
            }
            </script>
        
            <div class="student">
                <p class="grade">D3 </p>
                <p class="name">妻鹿</p>
                <p id="test_1" data-target="modal1" class="waves-effect modal-trigger status kitaku" onclick="test(1);">帰宅</p>
            </div>

            <div class="student">
                <p class="grade">M2</p>
                <p class="name">緒方</p>
                <p id="test_2" data-target="modal1" class="waves-effect modal-trigger status kitaku" onclick="test(2);">帰宅</p>
            </div>

            <div class="student">
                <p class="grade">M2</p>
                <p class="name">益井</p>
                <p id="test_3" data-target="modal1" class="waves-effect modal-trigger status zaishitsu" onclick="test(3);">在室</p>
            </div>

            <div class="student">
                <p class="grade">M2</p>
                <p class="name">村上</p>
                <p id="test_4" data-target="modal1" class="waves-effect modal-trigger status zaishitsu" onclick="test(4);">在室</p>
            </div>

            <div class="student">
                <p class="grade">M2</p>
                <p class="name">吉井</p>
                <p id="test_5" data-target="modal1" class="waves-effect modal-trigger status gakugai" onclick="test(5);">学外</p>
            </div>

            <div class="student">
                <p class="grade">M1</p>
                <p class="name">若松</p>
                <p id="test_6" data-target="modal1" class="waves-effect modal-trigger status gakunai" onclick="test(6);">学内</p>
            </div>

            <div class="student">
                <p class="grade">B4</p>
                <p class="name">？？</p>
                <p id="test_7" data-target="modal1" class="waves-effect modal-trigger status kitaku" onclick="test(7);">帰宅</p>
            </div>

            <div class="student">
                <p class="grade">B4</p>
                <p class="name">？？</p>
                <p id="test_8" data-target="modal1" class="waves-effect modal-trigger status kitaku" onclick="test(8);">帰宅</p>
            </div>

            <div class="student">
                <p class="grade">B4</p>
                <p class="name">？？</p>
                <p id="test_9" data-target="modal1" class="waves-effect modal-trigger status kitaku" onclick="test(9);">帰宅</p>
            </div>
        </div>

        <!-- modal window -->
        <!-- ここがモーダル画面なのでサイズ変更お願いします。byのり -->
        <div id="modal1" class="modal">
            <div id="modal_content" class="modal-table modal-content">
                <a class="button modal-close waves-effect waves-light btn-large red accent-3" onclick="ChangeStatus(0);"><i id="icon" class="material-icons left">child_care</i>在室</a>
                <a class="button modal-close waves-effect waves-light btn-large teal accent-4" onclick="ChangeStatus(1);"><i id="icon" class="material-icons right">home</i>帰宅</a>
                <a class="button modal-close waves-effect waves-light btn-large amber darken-2" onclick="ChangeStatus(2);"><i id="icon" class="material-icons left">airline_seat_flat</i>学内</a>
                <a class="button modal-close waves-effect waves-light btn-large light-blue darken-2" onclick="ChangeStatus(3);"><i id="icon" class="material-icons right">airplanemode_active</i>学外</a>
            </div>
            <!-- <div class="modal-footer">
                <a href="#!" class="modal-close waves-effect waves-green btn-flat">Agree</a>
            </div> -->
        </div>

        <input id="modal_index" type="hidden" value="">
    </body>
"
<script>
    document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('.modal');
    var instances = M.Modal.init(elems);
  });
  function test(index){
      modal = document.getElementById("modal_index"); // モーダルの取得
      modal.value = index; // モーダルのインデックスを固定
  }
  function ChangeStatus(status){
      var item = document.getElementById("modal_index").value;
      var id = "test_"+item;
      target = document.getElementById(id);
      switch(status){
          case 0:
            target.className = "waves-effect modal-trigger status zaishitsu";
            target.textContent = "在室";
            break;
          case 1:
            target.className = "waves-effect modal-trigger status kitaku";
            target.textContent = "帰宅";
            break;
          case 2:
            target.className = "waves-effect modal-trigger status gakunai";
            target.textContent = "学内";
            break;
          case 3:
            target.className = "waves-effect modal-trigger status gakugai";
            target.textContent = "学外";
            break;
          default:
            target.className = "waves-effect modal-trigger status kitaku";
            target.textContent = "帰宅";
            break;
      }
  };
</script>
</html>